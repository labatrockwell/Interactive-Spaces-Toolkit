// lab_vidplayer_yt-r1.js - https://github.com/labatrockwell/Interactive-Spaces-Toolkit
(function(){var a=namespace("com.rockwellgroup.lab.toolkit");a.Controller.YouTubeController=function(b,c){a.Controller.BaseVideoController.call(this,b,c)};a.Controller.YouTubeController.prototype=a.Util.inherit(a.Controller.BaseVideoController.prototype);a.Controller.YouTubeController.prototype.loadVideoById=function(a){this.target.getYouTubePlayer().loadVideoById(a,0,"highres")};a.Controller.YouTubeController.prototype.loadPlaylist=function(b){a.log(LOG_NARRATE,"[YouTubeController] Loading up playlist",
b);this.target.getYouTubePlayer().loadPlaylist(b,0,0,"highres")};a.Controller.YouTubeController.prototype.setVolume=function(b){a.log(LOG_NARRATE,"[VOLUME]2 ",b);this.target.setVolume(b)};a.Controller.YouTubeController.prototype.getVolume=function(){a.log(LOG_NARRATE,"[GET VOLUME]2 ",this.target.getVolume());this.target.getVolume()};a.Controller.YouTubeController.prototype.playVideo=function(){a.log(LOG_NARRATE,"[YouTubeController] Playing Video");this.target.getYouTubePlayer().playVideo()};a.Controller.YouTubeController.prototype.nextVideo=
function(){this.target.getYouTubePlayer().nextVideo()};a.Controller.YouTubeController.prototype.previousVideo=function(){this.target.getYouTubePlayer().previousVideo()};a.Controller.YouTubeController.prototype.pauseVideo=function(){this.target.getYouTubePlayer().pauseVideo()};a.Controller.YouTubeController.prototype.stopVideo=function(){this.target.getYouTubePlayer().stopVideo()};a.Controller.YouTubeController.prototype.playOrPauseVideo=function(){1==this.target.getYouTubePlayer().getPlayerState()?
this.pauseVideo():this.playVideo()};a.Controller.YouTubeController.prototype.clearVideo=function(){this.target.getYouTubePlayer().clearVideo()}}).call(this);
(function(){var a=namespace("com.rockwellgroup.lab.toolkit");a.Model.YouTubeVideo=function(b){a.Model.BaseVideo.call(this,b)};a.Model.YouTubeVideo.prototype=a.Util.inherit(a.Model.BaseVideo.prototype);a.Model.YouTubeVideo.prototype.initialize=function(b,c){void 0!==c?(this.setTitle(c.entry.title.$t),this.setDescription(c.entry.content.$t),"function"===typeof b&&b()):this.id?(a.log("fetch"),this.fetch(b)):"function"===typeof b&&b()};a.Model.YouTubeVideo.prototype.fetch=function(b){var c=this;a.log(LOG_NARRATE,
"[SINGLE YT Video] Fetch",c);$.ajax({url:"http://gdata.youtube.com/feeds/api/videos/"+c.id+"?alt=json",dataType:"json",cache:!1,success:function(a){c.setTitle(a.entry.title.$t);c.setDescription(a.entry.content.$t);"function"===typeof b&&b()},error:function(c){a.log(LOG_ERROR,"[YouTubeVideo] error",c);"function"===typeof b&&b()}})};a.Model.YouTubePlaylist=function(b){a.Model.BasePlaylist.call(this,b);a.log(LOG_NARRATE,"[YT Video] YouTubePlaylist",this,b)};a.Model.YouTubePlaylist.prototype=a.Util.inherit(a.Model.BasePlaylist.prototype);
a.Model.YouTubePlaylist.prototype.update=function(b,c){a.log(LOG_NARRATE,"[YT Playlist] UPDATE",b);if(b){a.log(LOG_NARRATE,"[YT Playlist] Data Update");this.title=b.playlistTitle;this.collection=[];for(var d in b.videoArray){var e=b.videoArray[d],f=new a.Model.YouTubeVideo(e.id);f.setTitle(e.title);f.setDescription(e.description);f.setCategory(e.category);f.setThumbnail(e.thumbnail||"http://img.youtube.com/vi/"+e.id+"/hqdefault.jpg");this.collection.push(f)}c()}};a.Model.YouTubePlaylist.prototype.initialize=
function(b,c){a.log(LOG_NARRATE,"[YT Playlist] Initialize",this,c);var d=this;if(c){a.log(LOG_NARRATE,"[YT Playlist] Data Initialize");a.log("Init from Admin",c);a.log(c.playlistTitle);a.log(c.videoArray);a.log(parseInt(c.playlistOrder));d.title=c.playlistTitle;d.description=c.playlistDescription;d.order=parseInt(c.playlistOrder);for(var e in c.videoArray){var f=c.videoArray[e],g=new a.Model.YouTubeVideo(f.id);g.setTitle(f.title);g.setDescription(f.description);g.setCategory(f.category);g.setThumbnail(f.thumbnail||
"http://img.youtube.com/vi/"+f.id+"/hqdefault.jpg");d.addItem(g)}b()}else a.log(LOG_NARRATE,"[YT Playlist] Test Initialize"),$.ajax({url:"./test/"+d.id+"-playlist.json",dataType:"json",cache:!1,success:function(c){d.title=c.title;d.description=c.description;d.order=c.order;for(var f in c.videos){var h=c.videos[f],e=new a.Model.YouTubeVideo(h.id);e.setTitle(h.title);e.setDescription(h.description);e.setCategory(h.category);e.setThumbnail(h.thumbnail||"http://img.youtube.com/vi/"+h.id+"/hqdefault.jpg");
d.addItem(e)}b()},error:function(c){a.log(LOG_ERROR,"[YouTubePlaylist] error",c);b()}})}}).call(this);
(function(){var a=namespace("com.rockwellgroup.lab.toolkit");a.View.YouTubeTarget=function(b,c){a.View.BaseVideoPlayerTarget.call(this,b,c)};a.View.YouTubeTarget.prototype=a.Util.inherit(a.View.BaseVideoPlayerTarget.prototype);a.View.YouTubeTarget.prototype.initialize=function(b,c){var d=this,e=void 0!==c.controls?c.controls:0,f=void 0!==c.showinfo?c.showinfo:0,g=void 0!==c.rel?c.rel:0,i=void 0!==c.cc_load_policy?c.cc_load_policy:0;d.id="c"+a.View.CID++;d.$el.html($("<div/>").prop("id",this.id));
d.yt_player=new YT.Player(d.id,{height:d.$el.height(),width:d.$el.width(),playerVars:{controls:e,showinfo:f,rel:g,modestbranding:1,iv_load_policy:3,cc_load_policy:i},events:{onReady:b,onStateChange:function(a){var b={};if(a.target&&a.target.getVideoUrl)b.video_id=d.getVideoId(a.target.getVideoUrl()),b.screen_id=d.screen_id;-1===a.data?$(document).trigger("videoLoaded",b):0===a.data?$(document).trigger("videoEnded",b):1===a.data?$(document).trigger("videoPlaying",b):2===a.data?$(document).trigger("videoPaused",
b):3===a.data?$(document).trigger("videoBuffering",b):5===a.data&&$(document).trigger("videoCued",b)}}})};a.View.YouTubeTarget.prototype.getYouTubePlayer=function(){return this.yt_player};a.View.YouTubeTarget.prototype.getVideoId=function(b){b=a.Util.queryString(b);if(b.v)return b.v};a.View.YouTubeTarget.prototype.goFullScreen=function(){this.original_height=this.$el.height();this.original_width=this.$el.width();this.getYouTubePlayer().setSize($(window).width(),$(window).height());this.$el.addClass("full-screen")};
a.View.YouTubeTarget.prototype.setVolume=function(b){a.log("[VIEW] ",b);this.getYouTubePlayer().setVolume(b)};a.View.YouTubeTarget.prototype.getVolume=function(){a.log("[VIEW] getVolume ",this.getYouTubePlayer().getVolume());return this.getYouTubePlayer().getVolume()};a.View.YouTubeTarget.prototype.leaveFullScreen=function(){this.getYouTubePlayer().setSize(this.original_width,this.original_height);this.$el.removeClass("full-screen")}}).call(this);
